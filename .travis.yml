---
language: node_js
node_js:
  - "9"
services:
  - mongodb
  - postgresql
env:
  - PGUSER=postgres PGDATABASE=machinomy_test
before_install:
  - curl -o- -L https://yarnpkg.com/install.sh | bash -s -- --version 1.7.0
  - export PATH="$HOME/.yarn/bin:$PATH"
  - lerna bootstrap
before_script:
  - psql -c 'create database machinomy_test;' -U postgres -d postgres
script:
  - yarn lint
  - yarn build
  - cd packages/machinomy && yarn migrate
  - yarn test
